<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <link rel="stylesheet" href="/media/style.css" />
    <title>Zatoga</title>
    <meta name="apple-mobile-web-app-status-bar" content="#000000" />
    <meta name="theme-color" content="#000000" />
    <script async src="https://arc.io/widget.min.js#4Jpe4Zp2"></script>
  </head>
  <body style="overflow:hidden;">
    <!-- Stuff for login & loading -->
    <span class="login">
      <img class="rotate small" src="/media/icon.png"/>
      <h1 class="small">Zatoga <span class="stable basic online">v3.9</span><span class="stable premium hide">Premium</span><span class="stable offline hide">Offline</span><span class="beta hide">BETA</span></h1><br>
      <h3 class="small">Please log in to continue to Zatoga.</h3><br><br>
      <a onclick="window.open('https://www.irom.ga/login?app=' + location.host)">Log in/Sign up</a>
    </span>
    <span class="loading">
      <h1 class="center">Zatoga <span class="stable basic online">v4.0</span><span class="stable premium hide">Premium</span><span class="stable offline hide">Offline</span><span class="beta hide">BETA</span></h1><br><br><br>
      <img class="rotate fast center" src="/media/icon.png"/>
      <br><br><br><br><br><br>
      <h2 class="center">Loading...</h3>
    </span>
    <!-- Zatoga header -->
    <img class="rotate small" src="/media/icon.png"/>
    <h1 class="small">Zatoga <span class="stable basic online">v4.0</span><span class="stable premium hide">Premium</span><span class="stable offline hide">Offline </span><span class="beta hide">BETA</span></h1>
    <!-- Center buttons -->
    <center style="background-color: #333;width:100%;display:block;border-radius:10px;margin-top:5px;">
      <a class="mini gray" href='/app/info.html'>Info</a>
      <a class="mini gray" href='/app/updateinfo.html'>Update App</a>
      <a class="mini gray" href='/app/logout.html'>Logout</a>
    </center><br>
    <!-- Message & text -->
    <h3 class="small" id="message"></h3><br><br>
    <!--<span class="basic"><br><br></span>
    <span class="premium hide">
      <p>You have access to the latest two games because you have premium!</p>
    </span>-->
    <span id="completeCollection"></span>
    <script src="/media/app.js"></script>
    <script>
      resize(440, 590);
      async function loadGames() {
        // Load games list
        let games = await fetch("/app/games.json");
        games = await games.json();
        gameArray = [];
        for(var key in games) {
          gameArray.push(key);
        }
        // Game Curation
        let gameElems = "";
        function addGame(game,premium) {
          if(premium) {
            gameElems += "<span title='This game requires premium' style='display:block;'><a class='premium disabled' style='color:white;background-color:deepskyblue;' onclick='if(!this.classList.contains(`disabled`))location.href=`/app/games/online/play.html?game=" + game + "`'>▶️️️ " + game + "</a></span><br>";
          } else {
            gameElems += "<a href='/app/games/online/play.html?game=" + game + "'>▶️️️ " + game + "</a><br>";
          }
        }
        for(var count=gameArray.length-1;count>=0;count--) {
          let game = games[gameArray[count]];
          if(count > gameArray.length-3 || game["premium"]) {
            addGame(game["name"],true);
          } else {
            addGame(game["name"],false);
          }
        }
        document.getElementById("completeCollection").innerHTML = gameElems;
      }
      loadGames();
    </script>
  </body>
</html>